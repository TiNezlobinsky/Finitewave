
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/2D/plot_aliev_panfilov_2D_aniso.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_2D_plot_aliev_panfilov_2D_aniso.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_2D_plot_aliev_panfilov_2D_aniso.py:


AlievPanfilov2D (Aniso)
==========================

This example demonstrates how to use the Aliev-Panfilov model in 2D with
anisotropic tissue.

Anisotropy is set by specifying a fiber array (``CardiacTissue`` class) and
diffusion coefficients ``D_al``, ``D_ac`` (diffusion along and across fibers).
Always use ``AsymmetricStencil`` for weights computations in case of
anisotropic tissue.

.. GENERATED FROM PYTHON SOURCE LINES 14-55



.. image-sg:: /auto_examples/2D/images/sphx_glr_plot_aliev_panfilov_2D_aniso_001.png
   :alt: plot aliev panfilov 2D aniso
   :srcset: /auto_examples/2D/images/sphx_glr_plot_aliev_panfilov_2D_aniso_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Running AlievPanfilov2D:   0%|          | 0/3000 [00:00<?, ?it/s]    Running AlievPanfilov2D:   0%|          | 1/3000 [00:00<11:14,  4.45it/s]    Running AlievPanfilov2D:   2%|▏         | 71/3000 [00:00<00:10, 273.66it/s]    Running AlievPanfilov2D:   5%|▍         | 142/3000 [00:00<00:06, 427.92it/s]    Running AlievPanfilov2D:   7%|▋         | 214/3000 [00:00<00:05, 525.29it/s]    Running AlievPanfilov2D:  10%|▉         | 286/3000 [00:00<00:04, 587.53it/s]    Running AlievPanfilov2D:  12%|█▏        | 358/3000 [00:00<00:04, 628.43it/s]    Running AlievPanfilov2D:  14%|█▍        | 430/3000 [00:00<00:03, 655.52it/s]    Running AlievPanfilov2D:  17%|█▋        | 502/3000 [00:00<00:03, 674.16it/s]    Running AlievPanfilov2D:  19%|█▉        | 574/3000 [00:01<00:03, 687.03it/s]    Running AlievPanfilov2D:  22%|██▏       | 646/3000 [00:01<00:03, 695.81it/s]    Running AlievPanfilov2D:  24%|██▍       | 718/3000 [00:01<00:03, 701.94it/s]    Running AlievPanfilov2D:  26%|██▋       | 790/3000 [00:01<00:03, 705.37it/s]    Running AlievPanfilov2D:  29%|██▊       | 862/3000 [00:01<00:03, 707.66it/s]    Running AlievPanfilov2D:  31%|███       | 934/3000 [00:01<00:02, 710.11it/s]    Running AlievPanfilov2D:  34%|███▎      | 1006/3000 [00:01<00:02, 711.86it/s]    Running AlievPanfilov2D:  36%|███▌      | 1078/3000 [00:01<00:02, 713.23it/s]    Running AlievPanfilov2D:  38%|███▊      | 1150/3000 [00:01<00:02, 713.63it/s]    Running AlievPanfilov2D:  41%|████      | 1222/3000 [00:01<00:02, 714.48it/s]    Running AlievPanfilov2D:  43%|████▎     | 1294/3000 [00:02<00:02, 715.02it/s]    Running AlievPanfilov2D:  46%|████▌     | 1366/3000 [00:02<00:02, 715.46it/s]    Running AlievPanfilov2D:  48%|████▊     | 1438/3000 [00:02<00:02, 715.72it/s]    Running AlievPanfilov2D:  50%|█████     | 1510/3000 [00:02<00:02, 715.53it/s]    Running AlievPanfilov2D:  53%|█████▎    | 1582/3000 [00:02<00:01, 715.57it/s]    Running AlievPanfilov2D:  55%|█████▌    | 1654/3000 [00:02<00:01, 715.74it/s]    Running AlievPanfilov2D:  58%|█████▊    | 1726/3000 [00:02<00:01, 714.80it/s]    Running AlievPanfilov2D:  60%|█████▉    | 1798/3000 [00:02<00:01, 715.16it/s]    Running AlievPanfilov2D:  62%|██████▏   | 1870/3000 [00:02<00:01, 715.27it/s]    Running AlievPanfilov2D:  65%|██████▍   | 1942/3000 [00:02<00:01, 715.51it/s]    Running AlievPanfilov2D:  67%|██████▋   | 2014/3000 [00:03<00:01, 716.02it/s]    Running AlievPanfilov2D:  70%|██████▉   | 2086/3000 [00:03<00:01, 716.25it/s]    Running AlievPanfilov2D:  72%|███████▏  | 2158/3000 [00:03<00:01, 716.44it/s]    Running AlievPanfilov2D:  74%|███████▍  | 2230/3000 [00:03<00:01, 716.33it/s]    Running AlievPanfilov2D:  77%|███████▋  | 2302/3000 [00:03<00:00, 716.36it/s]    Running AlievPanfilov2D:  79%|███████▉  | 2374/3000 [00:03<00:00, 716.37it/s]    Running AlievPanfilov2D:  82%|████████▏ | 2446/3000 [00:03<00:00, 716.52it/s]    Running AlievPanfilov2D:  84%|████████▍ | 2518/3000 [00:03<00:00, 716.62it/s]    Running AlievPanfilov2D:  86%|████████▋ | 2590/3000 [00:03<00:00, 716.38it/s]    Running AlievPanfilov2D:  89%|████████▊ | 2662/3000 [00:03<00:00, 716.31it/s]    Running AlievPanfilov2D:  91%|█████████ | 2734/3000 [00:04<00:00, 716.41it/s]    Running AlievPanfilov2D:  94%|█████████▎| 2806/3000 [00:04<00:00, 716.53it/s]    Running AlievPanfilov2D:  96%|█████████▌| 2878/3000 [00:04<00:00, 716.65it/s]    Running AlievPanfilov2D:  98%|█████████▊| 2950/3000 [00:04<00:00, 715.87it/s]    Running AlievPanfilov2D: 100%|██████████| 3000/3000 [00:04<00:00, 678.92it/s]






|

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    import finitewave as fw

    # create a mesh of cardiomyocytes (elems = 1):
    n = 400
    tissue = fw.CardiacTissue2D([n, n])
    tissue.mesh = np.ones([n, n])
    tissue.add_boundaries()
    # add fibers orientation vectors
    tissue.fibers = np.zeros([n, n, 2])
    tissue.fibers[:, :, 0] = np.cos(0.25 * np.pi)
    tissue.fibers[:, :, 1] = np.sin(0.25 * np.pi)
    # add numeric method stencil for weights computations
    tissue.stencil = fw.AsymmetricStencil2D()
    tissue.D_al = 1
    tissue.D_ac = tissue.D_al/9

    # create model object and set up parameters:
    aliev_panfilov = fw.AlievPanfilov2D()
    aliev_panfilov.dt = 0.01
    aliev_panfilov.dr = 0.25
    aliev_panfilov.t_max = 30

    # set up stimulation parameters:
    stim_sequence = fw.StimSequence()
    stim_sequence.add_stim(fw.StimVoltageCoord2D(0, 1, n//2 - 3, n//2 + 3,
                                                 n//2 - 3, n//2 + 3))

    # add the tissue and the stim parameters to the model object:
    aliev_panfilov.cardiac_tissue = tissue
    aliev_panfilov.stim_sequence = stim_sequence

    aliev_panfilov.run()

    # show the potential map at the end of calculations:
    plt.figure()
    plt.imshow(aliev_panfilov.u)
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 6.051 seconds)


.. _sphx_glr_download_auto_examples_2D_plot_aliev_panfilov_2D_aniso.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_aliev_panfilov_2D_aniso.ipynb <plot_aliev_panfilov_2D_aniso.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_aliev_panfilov_2D_aniso.py <plot_aliev_panfilov_2D_aniso.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_aliev_panfilov_2D_aniso.zip <plot_aliev_panfilov_2D_aniso.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
