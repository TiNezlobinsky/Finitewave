
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/3D/plot_aliev_panfilov_3D_iso.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_3D_plot_aliev_panfilov_3D_iso.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_3D_plot_aliev_panfilov_3D_iso.py:


AlievPanfilov3D (Iso)
==========================

This example demonstrates how to use the Aliev-Panfilov model in 3D with
isotropic stencil.

.. GENERATED FROM PYTHON SOURCE LINES 9-50



.. image-sg:: /auto_examples/3D/images/sphx_glr_plot_aliev_panfilov_3D_iso_001.png
   :alt: plot aliev panfilov 3D iso
   :srcset: /auto_examples/3D/images/sphx_glr_plot_aliev_panfilov_3D_iso_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Running AlievPanfilov3D:   0%|          | 0/700 [00:00<?, ?it/s]    Running AlievPanfilov3D:   0%|          | 1/700 [00:00<03:56,  2.96it/s]    Running AlievPanfilov3D:   1%|          | 7/700 [00:00<00:34, 19.83it/s]    Running AlievPanfilov3D:   2%|▏         | 14/700 [00:00<00:20, 33.26it/s]    Running AlievPanfilov3D:   3%|▎         | 21/700 [00:00<00:16, 41.93it/s]    Running AlievPanfilov3D:   4%|▍         | 28/700 [00:00<00:14, 47.82it/s]    Running AlievPanfilov3D:   5%|▌         | 35/700 [00:00<00:12, 51.82it/s]    Running AlievPanfilov3D:   6%|▌         | 42/700 [00:01<00:12, 54.60it/s]    Running AlievPanfilov3D:   7%|▋         | 49/700 [00:01<00:11, 56.40it/s]    Running AlievPanfilov3D:   8%|▊         | 56/700 [00:01<00:11, 57.76it/s]    Running AlievPanfilov3D:   9%|▉         | 63/700 [00:01<00:10, 58.70it/s]    Running AlievPanfilov3D:  10%|█         | 70/700 [00:01<00:10, 59.38it/s]    Running AlievPanfilov3D:  11%|█         | 77/700 [00:01<00:10, 59.85it/s]    Running AlievPanfilov3D:  12%|█▏        | 84/700 [00:01<00:10, 60.19it/s]    Running AlievPanfilov3D:  13%|█▎        | 91/700 [00:01<00:10, 60.41it/s]    Running AlievPanfilov3D:  14%|█▍        | 98/700 [00:01<00:09, 60.52it/s]    Running AlievPanfilov3D:  15%|█▌        | 105/700 [00:02<00:09, 60.61it/s]    Running AlievPanfilov3D:  16%|█▌        | 112/700 [00:02<00:09, 60.70it/s]    Running AlievPanfilov3D:  17%|█▋        | 119/700 [00:02<00:09, 60.79it/s]    Running AlievPanfilov3D:  18%|█▊        | 126/700 [00:02<00:09, 60.59it/s]    Running AlievPanfilov3D:  19%|█▉        | 133/700 [00:02<00:09, 60.67it/s]    Running AlievPanfilov3D:  20%|██        | 140/700 [00:02<00:09, 60.71it/s]    Running AlievPanfilov3D:  21%|██        | 147/700 [00:02<00:09, 60.79it/s]    Running AlievPanfilov3D:  22%|██▏       | 154/700 [00:02<00:08, 60.81it/s]    Running AlievPanfilov3D:  23%|██▎       | 161/700 [00:02<00:08, 60.86it/s]    Running AlievPanfilov3D:  24%|██▍       | 168/700 [00:03<00:08, 60.80it/s]    Running AlievPanfilov3D:  25%|██▌       | 175/700 [00:03<00:08, 60.63it/s]    Running AlievPanfilov3D:  26%|██▌       | 182/700 [00:03<00:08, 60.43it/s]    Running AlievPanfilov3D:  27%|██▋       | 189/700 [00:03<00:08, 60.46it/s]    Running AlievPanfilov3D:  28%|██▊       | 196/700 [00:03<00:08, 60.57it/s]    Running AlievPanfilov3D:  29%|██▉       | 203/700 [00:03<00:08, 60.64it/s]    Running AlievPanfilov3D:  30%|███       | 210/700 [00:03<00:08, 60.73it/s]    Running AlievPanfilov3D:  31%|███       | 217/700 [00:03<00:07, 60.69it/s]    Running AlievPanfilov3D:  32%|███▏      | 224/700 [00:04<00:07, 60.58it/s]    Running AlievPanfilov3D:  33%|███▎      | 231/700 [00:04<00:07, 60.41it/s]    Running AlievPanfilov3D:  34%|███▍      | 238/700 [00:04<00:07, 60.58it/s]    Running AlievPanfilov3D:  35%|███▌      | 245/700 [00:04<00:07, 60.68it/s]    Running AlievPanfilov3D:  36%|███▌      | 252/700 [00:04<00:07, 60.62it/s]    Running AlievPanfilov3D:  37%|███▋      | 259/700 [00:04<00:07, 60.50it/s]    Running AlievPanfilov3D:  38%|███▊      | 266/700 [00:04<00:07, 60.61it/s]    Running AlievPanfilov3D:  39%|███▉      | 273/700 [00:04<00:07, 60.66it/s]    Running AlievPanfilov3D:  40%|████      | 280/700 [00:04<00:06, 60.62it/s]    Running AlievPanfilov3D:  41%|████      | 287/700 [00:05<00:06, 60.51it/s]    Running AlievPanfilov3D:  42%|████▏     | 294/700 [00:05<00:06, 60.29it/s]    Running AlievPanfilov3D:  43%|████▎     | 301/700 [00:05<00:06, 60.06it/s]    Running AlievPanfilov3D:  44%|████▍     | 308/700 [00:05<00:06, 60.21it/s]    Running AlievPanfilov3D:  45%|████▌     | 315/700 [00:05<00:06, 60.36it/s]    Running AlievPanfilov3D:  46%|████▌     | 322/700 [00:05<00:06, 60.51it/s]    Running AlievPanfilov3D:  47%|████▋     | 329/700 [00:05<00:06, 60.62it/s]    Running AlievPanfilov3D:  48%|████▊     | 336/700 [00:05<00:06, 60.65it/s]    Running AlievPanfilov3D:  49%|████▉     | 343/700 [00:05<00:05, 60.73it/s]    Running AlievPanfilov3D:  50%|█████     | 350/700 [00:06<00:05, 60.80it/s]    Running AlievPanfilov3D:  51%|█████     | 357/700 [00:06<00:05, 60.86it/s]    Running AlievPanfilov3D:  52%|█████▏    | 364/700 [00:06<00:05, 60.88it/s]    Running AlievPanfilov3D:  53%|█████▎    | 371/700 [00:06<00:05, 60.85it/s]    Running AlievPanfilov3D:  54%|█████▍    | 378/700 [00:06<00:05, 60.84it/s]    Running AlievPanfilov3D:  55%|█████▌    | 385/700 [00:06<00:05, 60.85it/s]    Running AlievPanfilov3D:  56%|█████▌    | 392/700 [00:06<00:05, 60.85it/s]    Running AlievPanfilov3D:  57%|█████▋    | 399/700 [00:06<00:04, 60.84it/s]    Running AlievPanfilov3D:  58%|█████▊    | 406/700 [00:07<00:04, 60.88it/s]    Running AlievPanfilov3D:  59%|█████▉    | 413/700 [00:07<00:04, 60.89it/s]    Running AlievPanfilov3D:  60%|██████    | 420/700 [00:07<00:04, 60.92it/s]    Running AlievPanfilov3D:  61%|██████    | 427/700 [00:07<00:04, 60.89it/s]    Running AlievPanfilov3D:  62%|██████▏   | 434/700 [00:07<00:04, 60.90it/s]    Running AlievPanfilov3D:  63%|██████▎   | 441/700 [00:07<00:04, 60.92it/s]    Running AlievPanfilov3D:  64%|██████▍   | 448/700 [00:07<00:04, 60.91it/s]    Running AlievPanfilov3D:  65%|██████▌   | 455/700 [00:07<00:04, 60.90it/s]    Running AlievPanfilov3D:  66%|██████▌   | 462/700 [00:07<00:03, 60.88it/s]    Running AlievPanfilov3D:  67%|██████▋   | 469/700 [00:08<00:03, 60.90it/s]    Running AlievPanfilov3D:  68%|██████▊   | 476/700 [00:08<00:03, 60.93it/s]    Running AlievPanfilov3D:  69%|██████▉   | 483/700 [00:08<00:03, 60.96it/s]    Running AlievPanfilov3D:  70%|███████   | 490/700 [00:08<00:03, 60.91it/s]    Running AlievPanfilov3D:  71%|███████   | 497/700 [00:08<00:03, 60.92it/s]    Running AlievPanfilov3D:  72%|███████▏  | 504/700 [00:08<00:03, 60.94it/s]    Running AlievPanfilov3D:  73%|███████▎  | 511/700 [00:08<00:03, 60.94it/s]    Running AlievPanfilov3D:  74%|███████▍  | 518/700 [00:08<00:02, 60.91it/s]    Running AlievPanfilov3D:  75%|███████▌  | 525/700 [00:08<00:02, 60.85it/s]    Running AlievPanfilov3D:  76%|███████▌  | 532/700 [00:09<00:02, 60.86it/s]    Running AlievPanfilov3D:  77%|███████▋  | 539/700 [00:09<00:02, 60.89it/s]    Running AlievPanfilov3D:  78%|███████▊  | 546/700 [00:09<00:02, 60.93it/s]    Running AlievPanfilov3D:  79%|███████▉  | 553/700 [00:09<00:02, 60.86it/s]    Running AlievPanfilov3D:  80%|████████  | 560/700 [00:09<00:02, 60.91it/s]    Running AlievPanfilov3D:  81%|████████  | 567/700 [00:09<00:02, 60.92it/s]    Running AlievPanfilov3D:  82%|████████▏ | 574/700 [00:09<00:02, 60.95it/s]    Running AlievPanfilov3D:  83%|████████▎ | 581/700 [00:09<00:01, 60.89it/s]    Running AlievPanfilov3D:  84%|████████▍ | 588/700 [00:10<00:01, 60.87it/s]    Running AlievPanfilov3D:  85%|████████▌ | 595/700 [00:10<00:01, 60.85it/s]    Running AlievPanfilov3D:  86%|████████▌ | 602/700 [00:10<00:01, 60.90it/s]    Running AlievPanfilov3D:  87%|████████▋ | 609/700 [00:10<00:01, 60.91it/s]    Running AlievPanfilov3D:  88%|████████▊ | 616/700 [00:10<00:01, 60.84it/s]    Running AlievPanfilov3D:  89%|████████▉ | 623/700 [00:10<00:01, 60.80it/s]    Running AlievPanfilov3D:  90%|█████████ | 630/700 [00:10<00:01, 60.87it/s]    Running AlievPanfilov3D:  91%|█████████ | 637/700 [00:10<00:01, 60.96it/s]    Running AlievPanfilov3D:  92%|█████████▏| 644/700 [00:10<00:00, 60.98it/s]    Running AlievPanfilov3D:  93%|█████████▎| 651/700 [00:11<00:00, 60.99it/s]    Running AlievPanfilov3D:  94%|█████████▍| 658/700 [00:11<00:00, 61.05it/s]    Running AlievPanfilov3D:  95%|█████████▌| 665/700 [00:11<00:00, 61.09it/s]    Running AlievPanfilov3D:  96%|█████████▌| 672/700 [00:11<00:00, 61.09it/s]    Running AlievPanfilov3D:  97%|█████████▋| 679/700 [00:11<00:00, 61.07it/s]    Running AlievPanfilov3D:  98%|█████████▊| 686/700 [00:11<00:00, 61.08it/s]    Running AlievPanfilov3D:  99%|█████████▉| 693/700 [00:11<00:00, 61.10it/s]    Running AlievPanfilov3D: 100%|█████████▉| 699/700 [00:11<00:00, 59.05it/s]






|

.. code-block:: Python


    import numpy as np

    import finitewave as fw

    # number of nodes on the side
    n = 100

    tissue = fw.CardiacTissue3D((n, n, n))
    # create a mesh of cardiomyocytes (elems = 1):
    tissue.mesh = np.ones([n, n, n])
    tissue.add_boundaries()
    # add numeric method stencil for weights computations
    tissue.stencil = fw.IsotropicStencil3D()

    aliev_panfilov = fw.AlievPanfilov3D()
    # set up numerical parameters:
    aliev_panfilov.dt = 0.01
    aliev_panfilov.dr = 0.25
    aliev_panfilov.t_max = 7
    # set up stimulation parameters:
    stim_sequence = fw.StimSequence()
    stim_sequence.add_stim(fw.StimVoltageCoord3D(0, 1,
                                                 n//2 - 5, n//2 + 5,
                                                 n//2 - 5, n//2 + 5,
                                                 n//2 - 5, n//2 + 5))

    # add the tissue and the stim parameters to the model object:
    aliev_panfilov.cardiac_tissue = tissue
    aliev_panfilov.stim_sequence = stim_sequence

    aliev_panfilov.run()

    # visualize the potential map in 3D
    vis_mesh = tissue.mesh.copy()
    vis_mesh[n//2:, n//2:, n//2:] = 0

    mesh_builder = fw.VisMeshBuilder3D()
    grid = mesh_builder.build_mesh(vis_mesh)
    grid = mesh_builder.add_scalar(aliev_panfilov.u, 'u')
    grid.plot(clim=[0, 1], cmap='viridis')


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 12.439 seconds)


.. _sphx_glr_download_auto_examples_3D_plot_aliev_panfilov_3D_iso.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_aliev_panfilov_3D_iso.ipynb <plot_aliev_panfilov_3D_iso.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_aliev_panfilov_3D_iso.py <plot_aliev_panfilov_3D_iso.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_aliev_panfilov_3D_iso.zip <plot_aliev_panfilov_3D_iso.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
