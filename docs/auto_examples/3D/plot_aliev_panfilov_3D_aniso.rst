
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/3D/plot_aliev_panfilov_3D_aniso.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_3D_plot_aliev_panfilov_3D_aniso.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_3D_plot_aliev_panfilov_3D_aniso.py:


AlievPanfilov3D (Aniso)
==========================

This example demonstrates how to use the Aliev-Panfilov model in 3D with
anisotropic stencil.

.. note::

    In anisotropic models, the ``AssymmetricStencil3D`` class should be used.

.. GENERATED FROM PYTHON SOURCE LINES 20-68



.. image-sg:: /auto_examples/3D/images/sphx_glr_plot_aliev_panfilov_3D_aniso_001.png
   :alt: plot aliev panfilov 3D aniso
   :srcset: /auto_examples/3D/images/sphx_glr_plot_aliev_panfilov_3D_aniso_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Running AlievPanfilov3D:   0%|          | 0/1000 [00:00<?, ?it/s]    Running AlievPanfilov3D:   0%|          | 1/1000 [00:00<06:00,  2.77it/s]    Running AlievPanfilov3D:   1%|          | 7/1000 [00:00<00:53, 18.40it/s]    Running AlievPanfilov3D:   1%|▏         | 13/1000 [00:00<00:33, 29.16it/s]    Running AlievPanfilov3D:   2%|▏         | 19/1000 [00:00<00:26, 36.58it/s]    Running AlievPanfilov3D:   2%|▎         | 25/1000 [00:00<00:23, 41.74it/s]    Running AlievPanfilov3D:   3%|▎         | 31/1000 [00:00<00:21, 45.37it/s]    Running AlievPanfilov3D:   4%|▎         | 37/1000 [00:01<00:20, 47.92it/s]    Running AlievPanfilov3D:   4%|▍         | 43/1000 [00:01<00:19, 49.65it/s]    Running AlievPanfilov3D:   5%|▍         | 49/1000 [00:01<00:18, 50.91it/s]    Running AlievPanfilov3D:   6%|▌         | 55/1000 [00:01<00:18, 51.80it/s]    Running AlievPanfilov3D:   6%|▌         | 61/1000 [00:01<00:17, 52.42it/s]    Running AlievPanfilov3D:   7%|▋         | 67/1000 [00:01<00:17, 52.86it/s]    Running AlievPanfilov3D:   7%|▋         | 73/1000 [00:01<00:17, 53.10it/s]    Running AlievPanfilov3D:   8%|▊         | 79/1000 [00:01<00:17, 53.28it/s]    Running AlievPanfilov3D:   8%|▊         | 85/1000 [00:01<00:17, 53.44it/s]    Running AlievPanfilov3D:   9%|▉         | 91/1000 [00:02<00:16, 53.57it/s]    Running AlievPanfilov3D:  10%|▉         | 97/1000 [00:02<00:16, 53.66it/s]    Running AlievPanfilov3D:  10%|█         | 103/1000 [00:02<00:16, 53.68it/s]    Running AlievPanfilov3D:  11%|█         | 109/1000 [00:02<00:16, 53.74it/s]    Running AlievPanfilov3D:  12%|█▏        | 115/1000 [00:02<00:16, 53.76it/s]    Running AlievPanfilov3D:  12%|█▏        | 121/1000 [00:02<00:16, 53.80it/s]    Running AlievPanfilov3D:  13%|█▎        | 127/1000 [00:02<00:16, 53.81it/s]    Running AlievPanfilov3D:  13%|█▎        | 133/1000 [00:02<00:16, 53.81it/s]    Running AlievPanfilov3D:  14%|█▍        | 139/1000 [00:02<00:15, 53.83it/s]    Running AlievPanfilov3D:  14%|█▍        | 145/1000 [00:03<00:15, 53.82it/s]    Running AlievPanfilov3D:  15%|█▌        | 151/1000 [00:03<00:15, 53.82it/s]    Running AlievPanfilov3D:  16%|█▌        | 157/1000 [00:03<00:15, 53.80it/s]    Running AlievPanfilov3D:  16%|█▋        | 163/1000 [00:03<00:15, 53.80it/s]    Running AlievPanfilov3D:  17%|█▋        | 169/1000 [00:03<00:15, 53.83it/s]    Running AlievPanfilov3D:  18%|█▊        | 175/1000 [00:03<00:15, 53.84it/s]    Running AlievPanfilov3D:  18%|█▊        | 181/1000 [00:03<00:15, 53.80it/s]    Running AlievPanfilov3D:  19%|█▊        | 187/1000 [00:03<00:15, 53.79it/s]    Running AlievPanfilov3D:  19%|█▉        | 193/1000 [00:03<00:14, 53.82it/s]    Running AlievPanfilov3D:  20%|█▉        | 199/1000 [00:04<00:14, 53.84it/s]    Running AlievPanfilov3D:  20%|██        | 205/1000 [00:04<00:14, 53.83it/s]    Running AlievPanfilov3D:  21%|██        | 211/1000 [00:04<00:14, 53.78it/s]    Running AlievPanfilov3D:  22%|██▏       | 217/1000 [00:04<00:14, 53.79it/s]    Running AlievPanfilov3D:  22%|██▏       | 223/1000 [00:04<00:14, 53.81it/s]    Running AlievPanfilov3D:  23%|██▎       | 229/1000 [00:04<00:14, 53.83it/s]    Running AlievPanfilov3D:  24%|██▎       | 235/1000 [00:04<00:14, 53.79it/s]    Running AlievPanfilov3D:  24%|██▍       | 241/1000 [00:04<00:14, 53.83it/s]    Running AlievPanfilov3D:  25%|██▍       | 247/1000 [00:04<00:13, 53.85it/s]    Running AlievPanfilov3D:  25%|██▌       | 253/1000 [00:05<00:13, 53.86it/s]    Running AlievPanfilov3D:  26%|██▌       | 259/1000 [00:05<00:13, 53.88it/s]    Running AlievPanfilov3D:  26%|██▋       | 265/1000 [00:05<00:13, 53.88it/s]    Running AlievPanfilov3D:  27%|██▋       | 271/1000 [00:05<00:13, 53.88it/s]    Running AlievPanfilov3D:  28%|██▊       | 277/1000 [00:05<00:13, 53.89it/s]    Running AlievPanfilov3D:  28%|██▊       | 283/1000 [00:05<00:13, 53.90it/s]    Running AlievPanfilov3D:  29%|██▉       | 289/1000 [00:05<00:13, 53.85it/s]    Running AlievPanfilov3D:  30%|██▉       | 295/1000 [00:05<00:13, 53.86it/s]    Running AlievPanfilov3D:  30%|███       | 301/1000 [00:05<00:12, 53.85it/s]    Running AlievPanfilov3D:  31%|███       | 307/1000 [00:06<00:12, 53.88it/s]    Running AlievPanfilov3D:  31%|███▏      | 313/1000 [00:06<00:12, 53.89it/s]    Running AlievPanfilov3D:  32%|███▏      | 319/1000 [00:06<00:12, 53.85it/s]    Running AlievPanfilov3D:  32%|███▎      | 325/1000 [00:06<00:12, 53.89it/s]    Running AlievPanfilov3D:  33%|███▎      | 331/1000 [00:06<00:12, 53.89it/s]    Running AlievPanfilov3D:  34%|███▎      | 337/1000 [00:06<00:12, 53.88it/s]    Running AlievPanfilov3D:  34%|███▍      | 343/1000 [00:06<00:12, 53.85it/s]    Running AlievPanfilov3D:  35%|███▍      | 349/1000 [00:06<00:12, 53.86it/s]    Running AlievPanfilov3D:  36%|███▌      | 355/1000 [00:06<00:12, 53.71it/s]    Running AlievPanfilov3D:  36%|███▌      | 361/1000 [00:07<00:12, 52.97it/s]    Running AlievPanfilov3D:  37%|███▋      | 367/1000 [00:07<00:12, 52.54it/s]    Running AlievPanfilov3D:  37%|███▋      | 373/1000 [00:07<00:11, 52.33it/s]    Running AlievPanfilov3D:  38%|███▊      | 379/1000 [00:07<00:12, 51.41it/s]    Running AlievPanfilov3D:  38%|███▊      | 385/1000 [00:07<00:11, 51.90it/s]    Running AlievPanfilov3D:  39%|███▉      | 391/1000 [00:07<00:11, 52.39it/s]    Running AlievPanfilov3D:  40%|███▉      | 397/1000 [00:07<00:11, 52.72it/s]    Running AlievPanfilov3D:  40%|████      | 403/1000 [00:07<00:11, 52.86it/s]    Running AlievPanfilov3D:  41%|████      | 409/1000 [00:07<00:11, 52.94it/s]    Running AlievPanfilov3D:  42%|████▏     | 415/1000 [00:08<00:11, 53.15it/s]    Running AlievPanfilov3D:  42%|████▏     | 421/1000 [00:08<00:10, 53.33it/s]    Running AlievPanfilov3D:  43%|████▎     | 427/1000 [00:08<00:10, 53.32it/s]    Running AlievPanfilov3D:  43%|████▎     | 433/1000 [00:08<00:11, 49.47it/s]    Running AlievPanfilov3D:  44%|████▍     | 439/1000 [00:08<00:11, 49.99it/s]    Running AlievPanfilov3D:  44%|████▍     | 445/1000 [00:08<00:10, 50.50it/s]    Running AlievPanfilov3D:  45%|████▌     | 451/1000 [00:08<00:10, 50.86it/s]    Running AlievPanfilov3D:  46%|████▌     | 457/1000 [00:08<00:10, 51.41it/s]    Running AlievPanfilov3D:  46%|████▋     | 463/1000 [00:09<00:10, 51.40it/s]    Running AlievPanfilov3D:  47%|████▋     | 469/1000 [00:09<00:10, 51.67it/s]    Running AlievPanfilov3D:  48%|████▊     | 475/1000 [00:09<00:10, 51.79it/s]    Running AlievPanfilov3D:  48%|████▊     | 481/1000 [00:09<00:09, 52.12it/s]    Running AlievPanfilov3D:  49%|████▊     | 487/1000 [00:09<00:09, 52.37it/s]    Running AlievPanfilov3D:  49%|████▉     | 493/1000 [00:09<00:09, 52.83it/s]    Running AlievPanfilov3D:  50%|████▉     | 499/1000 [00:09<00:09, 53.15it/s]    Running AlievPanfilov3D:  50%|█████     | 505/1000 [00:09<00:09, 53.22it/s]    Running AlievPanfilov3D:  51%|█████     | 511/1000 [00:09<00:09, 53.04it/s]    Running AlievPanfilov3D:  52%|█████▏    | 517/1000 [00:10<00:09, 52.82it/s]    Running AlievPanfilov3D:  52%|█████▏    | 523/1000 [00:10<00:09, 52.87it/s]    Running AlievPanfilov3D:  53%|█████▎    | 529/1000 [00:10<00:09, 51.91it/s]    Running AlievPanfilov3D:  54%|█████▎    | 535/1000 [00:10<00:08, 52.16it/s]    Running AlievPanfilov3D:  54%|█████▍    | 541/1000 [00:10<00:08, 51.88it/s]    Running AlievPanfilov3D:  55%|█████▍    | 547/1000 [00:10<00:08, 51.65it/s]    Running AlievPanfilov3D:  55%|█████▌    | 553/1000 [00:10<00:08, 52.02it/s]    Running AlievPanfilov3D:  56%|█████▌    | 559/1000 [00:10<00:08, 52.43it/s]    Running AlievPanfilov3D:  56%|█████▋    | 565/1000 [00:10<00:08, 52.20it/s]    Running AlievPanfilov3D:  57%|█████▋    | 571/1000 [00:11<00:08, 52.16it/s]    Running AlievPanfilov3D:  58%|█████▊    | 577/1000 [00:11<00:08, 52.61it/s]    Running AlievPanfilov3D:  58%|█████▊    | 583/1000 [00:11<00:07, 52.74it/s]    Running AlievPanfilov3D:  59%|█████▉    | 589/1000 [00:11<00:07, 52.85it/s]    Running AlievPanfilov3D:  60%|█████▉    | 595/1000 [00:11<00:07, 52.65it/s]    Running AlievPanfilov3D:  60%|██████    | 601/1000 [00:11<00:07, 52.12it/s]    Running AlievPanfilov3D:  61%|██████    | 607/1000 [00:11<00:07, 51.38it/s]    Running AlievPanfilov3D:  61%|██████▏   | 613/1000 [00:11<00:07, 51.66it/s]    Running AlievPanfilov3D:  62%|██████▏   | 619/1000 [00:12<00:07, 52.21it/s]    Running AlievPanfilov3D:  62%|██████▎   | 625/1000 [00:12<00:07, 52.47it/s]    Running AlievPanfilov3D:  63%|██████▎   | 631/1000 [00:12<00:07, 52.08it/s]    Running AlievPanfilov3D:  64%|██████▎   | 637/1000 [00:12<00:06, 52.48it/s]    Running AlievPanfilov3D:  64%|██████▍   | 643/1000 [00:12<00:06, 52.19it/s]    Running AlievPanfilov3D:  65%|██████▍   | 649/1000 [00:12<00:06, 51.12it/s]    Running AlievPanfilov3D:  66%|██████▌   | 655/1000 [00:12<00:06, 50.90it/s]    Running AlievPanfilov3D:  66%|██████▌   | 661/1000 [00:12<00:06, 50.94it/s]    Running AlievPanfilov3D:  67%|██████▋   | 667/1000 [00:12<00:06, 51.35it/s]    Running AlievPanfilov3D:  67%|██████▋   | 673/1000 [00:13<00:06, 51.94it/s]    Running AlievPanfilov3D:  68%|██████▊   | 679/1000 [00:13<00:06, 52.46it/s]    Running AlievPanfilov3D:  68%|██████▊   | 685/1000 [00:13<00:05, 52.90it/s]    Running AlievPanfilov3D:  69%|██████▉   | 691/1000 [00:13<00:05, 53.22it/s]    Running AlievPanfilov3D:  70%|██████▉   | 697/1000 [00:13<00:05, 53.43it/s]    Running AlievPanfilov3D:  70%|███████   | 703/1000 [00:13<00:05, 53.57it/s]    Running AlievPanfilov3D:  71%|███████   | 709/1000 [00:13<00:05, 53.54it/s]    Running AlievPanfilov3D:  72%|███████▏  | 715/1000 [00:13<00:05, 53.57it/s]    Running AlievPanfilov3D:  72%|███████▏  | 721/1000 [00:13<00:05, 53.68it/s]    Running AlievPanfilov3D:  73%|███████▎  | 727/1000 [00:14<00:05, 53.80it/s]    Running AlievPanfilov3D:  73%|███████▎  | 733/1000 [00:14<00:04, 53.72it/s]    Running AlievPanfilov3D:  74%|███████▍  | 739/1000 [00:14<00:04, 52.48it/s]    Running AlievPanfilov3D:  74%|███████▍  | 745/1000 [00:14<00:04, 51.70it/s]    Running AlievPanfilov3D:  75%|███████▌  | 751/1000 [00:14<00:04, 51.36it/s]    Running AlievPanfilov3D:  76%|███████▌  | 757/1000 [00:14<00:04, 51.22it/s]    Running AlievPanfilov3D:  76%|███████▋  | 763/1000 [00:14<00:04, 51.32it/s]    Running AlievPanfilov3D:  77%|███████▋  | 769/1000 [00:14<00:04, 51.95it/s]    Running AlievPanfilov3D:  78%|███████▊  | 775/1000 [00:14<00:04, 52.54it/s]    Running AlievPanfilov3D:  78%|███████▊  | 781/1000 [00:15<00:04, 52.95it/s]    Running AlievPanfilov3D:  79%|███████▊  | 787/1000 [00:15<00:03, 53.26it/s]    Running AlievPanfilov3D:  79%|███████▉  | 793/1000 [00:15<00:03, 53.47it/s]    Running AlievPanfilov3D:  80%|███████▉  | 799/1000 [00:15<00:03, 53.63it/s]    Running AlievPanfilov3D:  80%|████████  | 805/1000 [00:15<00:03, 53.62it/s]    Running AlievPanfilov3D:  81%|████████  | 811/1000 [00:15<00:03, 53.64it/s]    Running AlievPanfilov3D:  82%|████████▏ | 817/1000 [00:15<00:03, 53.64it/s]    Running AlievPanfilov3D:  82%|████████▏ | 823/1000 [00:15<00:03, 53.73it/s]    Running AlievPanfilov3D:  83%|████████▎ | 829/1000 [00:15<00:03, 53.74it/s]    Running AlievPanfilov3D:  84%|████████▎ | 835/1000 [00:16<00:03, 52.85it/s]    Running AlievPanfilov3D:  84%|████████▍ | 841/1000 [00:16<00:03, 51.38it/s]    Running AlievPanfilov3D:  85%|████████▍ | 847/1000 [00:16<00:02, 51.83it/s]    Running AlievPanfilov3D:  85%|████████▌ | 853/1000 [00:16<00:02, 52.34it/s]    Running AlievPanfilov3D:  86%|████████▌ | 859/1000 [00:16<00:02, 52.83it/s]    Running AlievPanfilov3D:  86%|████████▋ | 865/1000 [00:16<00:02, 53.20it/s]    Running AlievPanfilov3D:  87%|████████▋ | 871/1000 [00:16<00:02, 53.45it/s]    Running AlievPanfilov3D:  88%|████████▊ | 877/1000 [00:16<00:02, 53.62it/s]    Running AlievPanfilov3D:  88%|████████▊ | 883/1000 [00:17<00:02, 53.71it/s]    Running AlievPanfilov3D:  89%|████████▉ | 889/1000 [00:17<00:02, 53.63it/s]    Running AlievPanfilov3D:  90%|████████▉ | 895/1000 [00:17<00:01, 53.62it/s]    Running AlievPanfilov3D:  90%|█████████ | 901/1000 [00:17<00:01, 53.73it/s]    Running AlievPanfilov3D:  91%|█████████ | 907/1000 [00:17<00:01, 53.79it/s]    Running AlievPanfilov3D:  91%|█████████▏| 913/1000 [00:17<00:01, 53.85it/s]    Running AlievPanfilov3D:  92%|█████████▏| 919/1000 [00:17<00:01, 53.91it/s]    Running AlievPanfilov3D:  92%|█████████▎| 925/1000 [00:17<00:01, 53.99it/s]    Running AlievPanfilov3D:  93%|█████████▎| 931/1000 [00:17<00:01, 53.91it/s]    Running AlievPanfilov3D:  94%|█████████▎| 937/1000 [00:18<00:01, 53.51it/s]    Running AlievPanfilov3D:  94%|█████████▍| 943/1000 [00:18<00:01, 53.22it/s]    Running AlievPanfilov3D:  95%|█████████▍| 949/1000 [00:18<00:00, 53.41it/s]    Running AlievPanfilov3D:  96%|█████████▌| 955/1000 [00:18<00:00, 53.57it/s]    Running AlievPanfilov3D:  96%|█████████▌| 961/1000 [00:18<00:00, 53.62it/s]    Running AlievPanfilov3D:  97%|█████████▋| 967/1000 [00:18<00:00, 53.19it/s]    Running AlievPanfilov3D:  97%|█████████▋| 973/1000 [00:18<00:00, 51.86it/s]    Running AlievPanfilov3D:  98%|█████████▊| 979/1000 [00:18<00:00, 51.04it/s]    Running AlievPanfilov3D:  98%|█████████▊| 985/1000 [00:18<00:00, 50.60it/s]    Running AlievPanfilov3D:  99%|█████████▉| 991/1000 [00:19<00:00, 50.04it/s]    Running AlievPanfilov3D: 100%|█████████▉| 997/1000 [00:19<00:00, 50.20it/s]    Running AlievPanfilov3D: 100%|██████████| 1000/1000 [00:19<00:00, 51.96it/s]






|

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    import finitewave as fw

    # number of nodes on the side
    n = 100

    tissue = fw.CardiacTissue3D((n, n, n))
    # create a mesh of cardiomyocytes (elems = 1):
    tissue.mesh = np.ones([n, n, n])
    tissue.add_boundaries()
    # add fibers orientation vectors
    theta, alpha = 0.25*np.pi, 0.1*np.pi/4
    tissue.fibers = np.zeros((n, n, n, 3))
    tissue.fibers[:, :, :, 0] = np.cos(theta) * np.cos(alpha)
    tissue.fibers[:, :, :, 1] = np.cos(theta) * np.sin(alpha)
    tissue.fibers[:, :, :, 2] = np.sin(theta)
    # add numeric method stencil for weights computations
    tissue.stencil = fw.AsymmetricStencil3D()
    tissue.D_al = 1
    tissue.D_ac = tissue.D_al/9

    # create model object:
    aliev_panfilov = fw.AlievPanfilov3D()
    # set up numerical parameters:
    aliev_panfilov.dt = 0.01
    aliev_panfilov.dr = 0.25
    aliev_panfilov.t_max = 10
    # set up stimulation parameters:
    stim_sequence = fw.StimSequence()
    stim_sequence.add_stim(fw.StimVoltageCoord3D(0, 1, n//2 - 5, n//2 + 5,
                                                 n//2 - 5, n//2 + 5,
                                                 n//2 - 5, n//2 + 5))
    # add the tissue and the stim parameters to the model object:
    aliev_panfilov.cardiac_tissue = tissue
    aliev_panfilov.stim_sequence = stim_sequence
    # initialize model: compute weights, add stimuls, trackers etc.
    aliev_panfilov.run()

    vis_mesh = tissue.mesh.copy()
    vis_mesh[n//2:, n//2:, n//2:] = 0

    mesh_builder = fw.VisMeshBuilder3D()
    grid = mesh_builder.build_mesh(vis_mesh)
    grid = mesh_builder.add_scalar(aliev_panfilov.u, 'u')
    grid.plot(clim=[0, 1], cmap='viridis')


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 21.176 seconds)


.. _sphx_glr_download_auto_examples_3D_plot_aliev_panfilov_3D_aniso.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_aliev_panfilov_3D_aniso.ipynb <plot_aliev_panfilov_3D_aniso.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_aliev_panfilov_3D_aniso.py <plot_aliev_panfilov_3D_aniso.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_aliev_panfilov_3D_aniso.zip <plot_aliev_panfilov_3D_aniso.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
